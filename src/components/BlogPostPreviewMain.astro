---
import { getSanityImageURL, formatBlogPostDate } from "../utils/helpers.js";

export interface Props {
  post: any;
  idx: number;
}
const { post, idx } = Astro.props;
---

<article class="cardPreview shadow">
  <a href={`/article/${post.slug.current}`}>
    {
      post.formatData.slug.current === "dossiers-mensuels" && (
        <div class="label shadow">
          <span> dossier </span>
        </div>
      )
    }
    {
      idx != 5 && idx != 6 && post.mainImage && (
        <img
          class="post-main__img"
          loading="lazy"
          src={getSanityImageURL(post.mainImage).url()}
          alt={post.alt}
        />
      )
    }
    <div class="cardMain">
      <h2>
        {
          post.locationData && (
            <>
              <>
                <span class="ariane">{post.locationData[0].title}</span> -{" "}
              </>
            </>
          )
        }
        {post.title}
      </h2>

      <p>{post.excerpt}</p>
      <time>{formatBlogPostDate(post.publishedAt)}</time>
    </div>
  </a>
</article>

<style>
  .cardPreview {
    position: relative;
    width: 100%;
    height: 100%;
    background-color: var(--color-white);
  }

  .cardMain {
    padding: 12px;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  a:hover > .post-main__img {
    opacity: 0.8;
  }

  .post-main__img {
    width: 100%;
    aspect-ratio: 16 / 9;
    object-fit: cover;
    transition: 0.2s;
  }

  .title,
  .author,
  .publish-date {
    margin: 0;
  }

  .publish-date,
  .author {
    font-size: 1.25rem;
    color: var(--theme-text-lighter);
  }

  .title {
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--theme-text);
  }

  .label {
    z-index: 1;
    position: absolute;
    background-color: var(--color-red);
    right: var(--margin);
    text-transform: uppercase;
    color: var(--color-white);
    padding: 4px var(--margin);
    border-radius: 0 0 10px 10px;
    font-family: var(--subtitle-font);
    font-size: 1.2rem;
  }
</style>
